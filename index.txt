lot of code to operate